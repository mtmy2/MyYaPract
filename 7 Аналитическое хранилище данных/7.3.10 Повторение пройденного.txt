Повторение пройденного
Вы выполнили просьбу Алисы и разобрались в особенностях DWH, OLTP- и OLAP-систем, а также познакомились с денормализованными моделями «звезда» и «снежинка». Эта тема была насыщенной. Рекомендуем повторить ключевые тезисы перед тем, как двигаться дальше.
Минусы нормализации
Нормализация — далеко не универсальное решения для хранения данных. У нормальных форм есть ряд недостатков:
Сложность проектирования.

Нормализовать данные — непросто. Нормализация всегда подразумевает высокие трудозатраты.
Избыточность данных.

Зачастую нормализация данных сопровождается их повторением. Кроме того, большее число таблиц занимает много места и требует больших ресурсов для обработки.
Проблемы с производительностью.

Некоторые операции (например, поиск или обновление данных) могут занимать больше времени и требовать больше ресурсов в нормализованных БД.
Хранилище данных (DWH)
Хранилище данных (англ. Data Warehouse, сокращённо DWH) — класс систем для хранения обработанных данных из разных источников. 
Хранилища изначально были разработаны для пользователей со стороны бизнеса и без достаточного опыта в IT, чтобы им было удобнее анализировать данные. Поэтому они хранят уже очищенные данные и предоставляют инструменты для их лёгкого просмотра. 
На каждом уровне решается своя задача. От уровня к уровню данные проходят преобразование с помощью ETL/ELT-процессов. Они отвечают за наполнение данными различных слоёв. В зависимости от потребностей заказчика состав слоёв может меняться. Самая распространённая конфигурация выглядит так:
Staging-область (англ. Staging Area).

Это область временного хранения данных. Её задача — побыстрее выгрузить данные из источников, чтобы освободить их от дополнительной нагрузки и не мешать другим процессам.
Ядро DWH.

Здесь хранятся очищенные данные.
Витрина данных (англ. Data Mart).

Это срез данных из хранилища, подготовленный для конкретных пользователей. Витрины упрощают анализ.
DWH хранят большой объём исторических данных и рассчитаны на аналитическую нагрузку. Поэтому для работы с ними выбирают соответствующие оптимизированные базы данных (Vertica, Greenplum, ClickHouse, Exasol, Teradata, Exadata, SAP HANA и др.)
OLTP vs OLAP
OLTP-модель используют для систем с частой вставкой, удалением или изменением данных. От англ. Online Transaction Processing — «транзакционная обработка в реальном времени». Для реализации аналитической обработки данных существует многомерная, или OLAP-модель (от англ. Online Analytical Processing — оперативная аналитическая обработка).
Напомним ключевые характеристики OLTP- и OLAP-систем:
OLTP БД	OLAP БД
Назначение	Непрерывная обработка данных бизнеса в режиме реального времени (вставка, обновление и удаление), предоставление конкурентного доступа к актуальным данным для множества пользователей.	Анализ большого объёма данных для принятия стратегических решений.
Профиль нагрузки	Пишущий	Читающий
Использование ключей и индексов	PK, FK и индексы — обязательная часть системы. Они ускоряют операции построчного добавления, обновления и удаления данных, а также обеспечивают ссылочную целостность между связанными таблицами.	PK, FK и индексы — вспомогательная часть системы. Они могут и вовсе не использоваться. Эффективную аналитику и агрегацию данных обеспечивает оптимизация структуры данных и запросов.
Вид оптимизации	Оптимизирована для построчной вставки и чтения.	Оптимизирована для вставки и чтения большого количества строк.
Нормализация данных	Данные нормализованы.	Данные денормализированы.
Этапы проектирования DWH
Сбор требований.

Вначале важно ответить на все возможные вопросы, связанные с будущим хранилищем. Например, каким образом оно будет использоваться, какие данные будут в нём лежать, сколько и т. д.
Выбор модели хранилища данных.

Выбор модели зависит от ваших требований к производительности, лёгкости проектирования или использования, а также к объёму данных. Из выбранного подхода должна родиться структура данных: слои (схемы), таблицы и поля.
Проектирование процессов сбора и обработки данных (ETL/ELT-процессы).

ETL- и ELT-процессы отвечают за извлечение данных из источников, их очищение, трансформирование и загрузку в хранилище. Позже вы подробнее изучите эти процессы.
Тестирование и оптимизация.
Масштабирование.

Со временем данных точно не станет меньше, поэтому нужно понимать, куда вы их будете складывать и какими мощностями обрабатывать.
Обеспечение безопасности.

Внимательно отнеситесь к ролевым моделям, разграничениям доступа и механизмам авторизации.
Документирование.

Документация позволит быстро погрузиться в работу с хранилищем вашим коллегам.
Это основные этапы проектирования DWH. Однако его создание — итеративный процесс, и решения, принятые на ранних этапах, могут изменяться с течением времени. Будьте готовы адаптироваться к изменениям и улучшать DWH на основе обратной связи и опыта использования.
Модели «звезда» и «снежинка»
«Звезда» и «снежинка» — две формы хранения данных в многомерной модели. Обе денормализованные. При проектировании OLAP специально разрабатывают схемы, которые нарушают правила третьей нормальной формы и последующих. Из-за этого данные занимают больше места на диске. Однако меньшее число таблиц позволяет получить доступ к данным проще и быстрее, и вся нужная для анализа информация может хранится в одной таблице.
В «звезде» в центре схемы расположена таблица с фактами — максимально детальными показателями. От неё, как лучи звезды, расходятся связи с таблицами других измерений.

В «снежинке» в центральной части — тоже таблица фактов. И к ней тоже присоединены таблицы измерений. Но к ним, в свою очередь, могут быть присоединены другие таблицы измерений. Например, на схеме ниже таблица измерений Категория связана с измерением Продукт. То есть у лучей звезды появились свои лучи, и в таком виде визуально схема напоминает снежинку. В итоге получается иерархия Название категории → Название продукта.

Сравнительная таблица характеристик «звезды» и «снежинки»:
«Звезда»	«Снежинка»
Связь таблиц	Таблицы измерений могут быть связаны только с таблицей фактов.	Таблицы измерений могут быть связаны и с таблицей фактов, и с другими таблицами измерений.
Иерархия измерений	В иерархиях не может быть больше одной таблицы измерений.	Иерархии могут быть построены на нескольких таблицах измерений.
Степень денормализации	Денормализованная структура.	Промежуточный вариант между нормальной формой и денормализованной (близко к 3NF).
Скорость запросов	Максимальная скорость аналитического запроса.	Может медленнее отвечать на запросы из-за большего количества соединений.
Занимаемое место	Занимает больше места на диске.	Занимает меньше места на диске.
Теперь эта тема точно вами пройдена. В следующей вы продолжите погружаться в процесс проектирования хранилища данных.

