Что такое DWH
Хранилище данных (англ. Data Warehouse) — класс систем для хранения обработанных данных из разных источников. Хранилища изначально были разработаны для пользователей со стороны бизнеса и без достаточного опыта в IT, чтобы им было удобнее анализировать данные. Поэтому этот класс систем обладает следующими признаками:
Лёгкость просмотра данных.

Чтобы получить данные, можно написать несложные SQL-запросы или настроить отчёты.
Хранение очищенных данных.

Перед тем как попасть в хранилище, данные обрабатываются, чтобы пользователи работали уже с чистой информацией.
Объясним преимущества DWH на примере. В больших компаниях обычно существует деление на департаменты: маркетинга, информационных технологий, продаж и так далее. Каждый департамент собирает данные и размещает их в локальной базе. 
Допустим, аналитику этой компании понадобилось проанализировать, как одна из маркетинговых кампаний повлияла на продажи. Если в компании нет DWH, то аналитику сначала придётся пройтись по базам департаментов и собрать оттуда нужную информацию. Затем данные нужно будет очистить: сопоставить таблицы, привести их к одной структуре, удалить дубли, аномалии и прочие неприятности. И только после всего этого аналитик сможет наконец приступить к анализу.
Аналитику предстоит долгий путь, показанный на схеме. Предположим, он собирает данные в файл shop_address, чтобы затем их проанализировать. Для этого ему нужно написать запрос для извлечения данных из marketing_department_db и sales_department_db. Из первой базы соберётся файл d_location, из второй — d_address. Затем аналитику нужно будет написать скрипты для обработки этих данных, чтобы собрать их в shop_address и написать аналитические запрос, чтобы получить результаты анализа. А ведь баз может быть и больше, а значит, и шагов тоже! На схеме эти базы обозначены как other_department_db.
Если бы в компании существовало хранилище данных, то проходить все эти этапы аналитику бы не понадобилось — о них позаботились бы инженеры данных, автоматизировав выгрузку, очистку и размещение данных в хранилище. Аналитику осталось бы только написать запрос к DWH и получить выборку для исследования. Более того, если такую выборку аналитик захочет получать каждый месяц, выгрузку отчёта инженеры тоже смогут автоматизировать. Красота, не правда ли?
На схеме с помощью ETL/ELT-процессов данные из разных департаментов сами собираются в DWH. Аналитику остаётся только написать аналитический запрос и получить результаты.
Архитектура хранилища данных
Для того чтобы аналитику жилось хорошо, инженеру данных нужно:
автоматизировать извлечение данных из источников;
реализовать очистку данных;
организовать корректное хранение исторических данных;
реализовать предоставление данных пользователю в удобном виде.
Справиться с этими задачами инженерам помогает многослойная архитектура хранилища данных. На каждом уровне решается своя задача. От уровня к уровню данные проходят преобразование с помощью ETL/ELT-процессов. Они отвечают за наполнение данными различных слоёв. Ближе с ними вы познакомитесь чуть позже в курсе.
В зависимости от потребностей заказчика состав слоёв может меняться. Самая распространённая конфигурация выглядит так:
Staging-область (англ. Staging Area).

Это область временного хранения данных. Этот слой характерен для решений с ELT-процессами, так как в них данные из источников попадают в ядро хранилища без предварительной обработки. Задача staging-области — побыстрее выгрузить данные из источников, чтобы освободить их от дополнительной нагрузки и не мешать другим процессам. Поэтому часто эту область делают максимально похожей на соответствующий источник.

Staging-слой может быть накопительным. Это означает, что данные будут загружаться в него инкрементально — новая информация добавляется, старая не удаляется. Информацию из системы-источника, загруженную в staging-область, можно восстановить просто по дате загрузки.

ETL-процесс — другое дело. Данные сначала преобразуются, а уже потом попадают в ядро хранилища. Здесь staging-область не нужна.
Ядро DWH.

После очистки и преобразований данные попадают в ядро. В рамках компании ядро — это точка доступа к согласованным и очищенным данным.
Витрина данных (англ. Data Mart).

Доступ непосредственно к хранилищу дают не всем. Во-первых, высока вероятность, что какой-нибудь неопытный пользователь может случайно удалить данные. Во-вторых, прямой доступ к хранилищу влечёт за собой повышение нагрузки, из-за чего могут пострадать процессы загрузки и обработки данных. Наконец, в хранилище могут содержаться чувствительные данные, к которым не у всех есть доступ в принципе.

Витрина данных — это подмножество данных из хранилища, подготовленное для конкретных пользователей. Она предназначена для упрощения анализа и принятия решений. Витрины данных можно сравнить с витринами магазинов — на них размещают не все товары со склада, а только часть, чтобы дать покупателям представление об ассортименте. Витрина данных предоставляет готовую информацию, которую пользователи могут использовать без необходимости разбираться во всей сложности и обширности основной базы данных. Подробнее витрины данных вы изучите в следующем спринте.
С DWH схема выше преобразуется. Теперь данные из marketing_department_db, sales_department_db и other_department_db с помощью ETL-процесса обрабатываются и оказываются в ядре DWH. С помощью ELT-процесса они сначала оказываются в Staging Area, а затем так же, через ELT-процесс, попадают в ядро. После этого через ETL/ELT-процессы попадают в Data Mart, к которой аналитик применяет аналитический запрос.
DWH хранят большой объём исторических данных и рассчитаны на аналитическую нагрузку. Поэтому для работы с ними выбирают соответствующие оптимизированные базы данных. Например, Vertica, Greenplum, ClickHouse, Exasol, Teradata, Exadata, SAP HANA.
Вы познакомились с DWH. Закрепите изученное и выберите верные утверждения.


Правильный ответ
Хранилища нужны, чтобы создать единый источник данных.
Первоочередная задача хранилищ — предоставлять одну версию информации внутри предприятия.

В хранилище лежат необработанные данные из множества источников.

Внутри компании любой пользователь должен иметь доступ ко всем слоям хранилища данных.

Правильный ответ
Хранилища данных строятся на аналитических базах данных.
Хранилища рассчитаны на аналитическую нагрузку, поэтому логично использовать для них БД, оптимизированные именно под этот вид нагрузки.
Соотнесите слои DWH и данные, которые в них лежат.



Здорово, если компания хранит данные правильно. Но просто хранить данные — мало, нужно их ещё и обрабатывать. Это можно делать по-разному, а как — расскажем в следующих уроках.

